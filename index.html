<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-180.png" />
  <title>Calculadora</title>
  <style>
    :root {
      --bg-color: #121212;
      --text-color: #ffffff;
      --card-bg: #1e1e1e;
      --input-bg: #2c2c2c;
      --border-radius: 12px;
      --btn-bg: #007bff;
      --muted: #9ea3a9;
    }

    body {
      margin: 0;
      padding: calc(env(safe-area-inset-top, 0px) + 16px) 16px 16px;
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
    }

    .container { width: 100%; max-width: 420px; }
    h1 { text-align: center; font-size: 1.5rem; margin: 0 0 18px; }

    /* Tabs */
    .tabs {
      display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 18px;
    }
    .tab-btn {
      padding: 10px 12px; border-radius: 10px; border: 1px solid #2f2f2f;
      background: #1a1a1a; color: var(--text-color); cursor: pointer; font-weight: 600;
    }
    .tab-btn.active { background: var(--btn-bg); border-color: var(--btn-bg); }

    label { display: block; margin-top: 14px; font-weight: bold; }
    .hint { margin: 4px 0 0; font-size: 12px; color: var(--muted); }

    input, select {
      width: 100%; padding: 10px; margin-top: 4px; border-radius: var(--border-radius);
      border: none; background-color: var(--input-bg); color: var(--text-color); box-sizing: border-box;
    }
    select {
      appearance: none; -webkit-appearance: none; -moz-appearance: none; padding-right: 2.5rem;
      background-image: url("data:image/svg+xml;utf8,<svg fill='white' height='20' viewBox='0 0 24 24' width='20' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/></svg>");
      background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1rem;
    }

    .row { display: grid; grid-template-columns: 1fr; gap: 8px; }
    .actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 16px; }

    button {
      width: 100%; padding: 12px; background-color: var(--btn-bg); color: white; font-weight: bold;
      border: none; border-radius: 12px; cursor: pointer;
    }

    .resultado { margin-top: 20px; padding: 16px; background-color: var(--card-bg); border-radius: var(--border-radius); }
    .resultado p { margin: 8px 0; }

    .fade { animation: fadeIn 0.35s ease-in-out; }
    @keyframes fadeIn { from { opacity: 0; transform: scale(0.985); } to { opacity: 1; transform: scale(1); } }

    .section { display: none; }
    .section.active { display: block; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Calculadora</h1>

    <!-- Abas -->
    <div class="tabs">
      <button id="tabHora" class="tab-btn active" onclick="mudarAba('hora')">Hora Extra</button>
      <button id="tabFerias" class="tab-btn" onclick="mudarAba('ferias')">F√©rias</button>
    </div>

    <!-- Se√ß√£o Hora Extra -->
    <section id="secHora" class="section active">
      <div class="row">
        <div>
          <label for="salario">üí∞ Sal√°rio Bruto (R$):</label>
          <input type="number" id="salario" placeholder="Informe seu sal√°rio bruto mensal.">
        </div>

        <div>
          <label for="horas">‚è∞ Horas Extras Trabalhadas:</label>
          <input type="number" id="horas" placeholder="Total de horas extras no m√™s.">
        </div>

        <div>
          <label for="percentual">üìà Porcentagem da Hora Extra:</label>
          <select id="percentual">
            <option value="0.5">50%</option>
            <option value="0.6" selected>60%</option>
            <option value="0.7">70%</option>
            <option value="0.8">80%</option>
            <option value="0.9">90%</option>
            <option value="1.0">100%</option>
            <option value="1.2">120%</option>
            <option value="2.0">200%</option>
          </select>
        </div>

        <div>
          <label for="carga">‚öôÔ∏è Carga Hor√°ria Mensal (horas):</label>
          <input type="number" id="carga" placeholder="Geralmente 156h, 160h ou 220h mensais.">
          <p class="hint">Dica: 156 = 36h/semana ¬∑ 4,33</p>
        </div>
      </div>

      <div class="actions">
        <button onclick="calcularHoraExtra()">Calcular</button>
        <button onclick="exemploHora()">Exemplo</button>
      </div>

      <div class="resultado" id="resultadoHora" style="display: none;"></div>
    </section>

    <!-- Se√ß√£o F√©rias -->
    <section id="secFerias" class="section">
      <div class="row">
        <div>
          <label for="salarioFerias">üí∞ Sal√°rio Bruto (R$):</label>
          <input type="number" id="salarioFerias" placeholder="Use o mesmo sal√°rio bruto mensal.">
          <p class="hint">Se preferir, repita o sal√°rio aqui s√≥ para f√©rias.</p>
        </div>

        <div>
          <label for="diasFerias">üìÖ Dias de f√©rias:</label>
          <input type="number" id="diasFerias" min="1" max="30" placeholder="Ex.: 30" oninput="atualizarLimiteAbono()">
          <p id="hintDias" class="hint">C√°lculo proporcional caso informe menos de 30 dias.</p>
        </div>

        <div>
          <label for="diasAbono">üí† Dias a vender (abono):</label>
          <input type="number" id="diasAbono" min="0" placeholder="Ex.: 10" oninput="limitarAbono()">
          <p id="hintAbono" class="hint">Voc√™ pode vender at√© 1/3 dos dias de f√©rias (m√°x. exibido aqui).</p>
        </div>
      </div>

      <div class="actions">
        <button onclick="calcularFerias()">Calcular</button>
        <button onclick="exemploFerias()">Exemplo</button>
      </div>

      <div class="resultado" id="resultadoFerias" style="display: none;"></div>
    </section>
  </div>

  <script>
    // ---------- Tabs ----------
    function mudarAba(qual) {
      const secHora = document.getElementById('secHora');
      const secFerias = document.getElementById('secFerias');
      const tabHora = document.getElementById('tabHora');
      const tabFerias = document.getElementById('tabFerias');

      if (qual === 'hora') {
        secHora.classList.add('active');
        secFerias.classList.remove('active');
        tabHora.classList.add('active');
        tabFerias.classList.remove('active');
        localStorage.setItem('aba', 'hora');
      } else {
        secFerias.classList.add('active');
        secHora.classList.remove('active');
        tabFerias.classList.add('active');
        tabHora.classList.remove('active');
        localStorage.setItem('aba', 'ferias');
        // Atualiza limites quando chega na aba
        atualizarLimiteAbono();
      }
    }

    // ---------- Hora Extra ----------
    function calcularHoraExtra() {
      const salario = parseFloat(document.getElementById('salario').value);
      const horas = parseFloat(document.getElementById('horas').value);
      const percentual = parseFloat(document.getElementById('percentual').value);
      const carga = parseFloat(document.getElementById('carga').value);
      const out = document.getElementById('resultadoHora');

      if (isNaN(salario) || isNaN(horas) || isNaN(percentual) || isNaN(carga) || carga <= 0) {
        out.innerHTML = "<p>‚ö†Ô∏è Preencha todos os campos corretamente.</p>";
        out.style.display = "block";
        out.classList.add("fade");
        return;
      }

      const valorHora = salario / carga;
      const valorExtra = valorHora * (1 + percentual);
      const totalExtras = valorExtra * horas;

      out.innerHTML = `
        <p>üíµ Valor da hora: R$ ${valorHora.toFixed(2)}</p>
        <p>‚ûï Hora extra (${(percentual * 100).toFixed(0)}%): R$ ${valorExtra.toFixed(2)}</p>
        <p>üßæ Total das horas extras: R$ ${totalExtras.toFixed(2)}</p>
      `;
      out.style.display = "block";
      out.classList.remove("fade");
      void out.offsetWidth; // reflow
      out.classList.add("fade");

      localStorage.setItem("dadosHora", JSON.stringify({ salario, horas, percentual, carga }));
    }

    function exemploHora() {
      document.getElementById('salario').value = 3000;
      document.getElementById('horas').value = 10;
      document.getElementById('percentual').value = 0.6;
      document.getElementById('carga').value = 156;
      calcularHoraExtra();
    }

    // ---------- F√©rias ----------
    function diasAbonoMaximos(diasFerias) {
      // Regra: at√© 1/3 dos dias de f√©rias
      const max = Math.floor(diasFerias / 3);
      return max < 0 ? 0 : max;
    }

    function atualizarLimiteAbono() {
      const dias = parseFloat(document.getElementById('diasFerias').value);
      const abonoInput = document.getElementById('diasAbono');
      const hintAbono = document.getElementById('hintAbono');

      if (isNaN(dias) || dias <= 0) {
        abonoInput.value = '';
        abonoInput.min = 0;
        abonoInput.max = 0;
        hintAbono.textContent = 'Informe os dias de f√©rias para ver o limite de abono.';
        return;
      }

      const max = diasAbonoMaximos(dias);
      abonoInput.min = 0;
      abonoInput.max = max;
      if (abonoInput.value !== '' && parseFloat(abonoInput.value) > max) {
        abonoInput.value = String(max);
      }
      hintAbono.textContent = `Voc√™ pode vender at√© ${max} dia(s) (${max > 0 ? '‚âà 1/3 dos dias informados' : 'sem abono dispon√≠vel'}).`;
    }

    function limitarAbono() {
      const dias = parseFloat(document.getElementById('diasFerias').value);
      const abonoInput = document.getElementById('diasAbono');
      const max = isNaN(dias) ? 0 : diasAbonoMaximos(dias);

      let val = parseFloat(abonoInput.value);
      if (isNaN(val)) return;
      if (val < 0) val = 0;
      if (val > max) val = max;
      abonoInput.value = String(val);
    }

    function calcularFerias() {
      const salario = parseFloat(document.getElementById('salarioFerias').value);
      const dias = parseFloat(document.getElementById('diasFerias').value);
      const diasAbono = parseFloat(document.getElementById('diasAbono').value || '0');
      const out = document.getElementById('resultadoFerias');

      if (isNaN(salario) || isNaN(dias) || dias <= 0 || dias > 30) {
        out.innerHTML = "<p>‚ö†Ô∏è Preencha sal√°rio e dias (1 a 30) corretamente.</p>";
        out.style.display = "block";
        out.classList.add("fade");
        return;
      }

      // Garante que o abono respeite o limite de 1/3
      const maxAbono = diasAbonoMaximos(dias);
      const abonoAjustado = Math.min(Math.max(0, Math.floor(diasAbono)), maxAbono);

      // Base proporcional √†s f√©rias gozadas
      const baseFerias = salario * (dias / 30);

      // 1/3 constitucional sobre a base das f√©rias
      const adicionalUmTerco = baseFerias / 3;

      // Abono pecuni√°rio: dias vendidos convertidos em dinheiro (sal√°rio * dias/30)
      const valorAbono = salario * (abonoAjustado / 30);

      const total = baseFerias + adicionalUmTerco + valorAbono;

      out.innerHTML = `
        <p>üóìÔ∏è Dias de f√©rias: ${dias} ${abonoAjustado > 0 ? `(vendidos ${abonoAjustado} dia(s))` : ''}</p>
        <p>üíµ Base f√©rias (proporcional): R$ ${baseFerias.toFixed(2)}</p>
        <p>‚ûï Adicional 1/3 constitucional: R$ ${adicionalUmTerco.toFixed(2)}</p>
        ${abonoAjustado > 0 ? `<p>üí† Abono (${abonoAjustado} dia(s) em dinheiro): R$ ${valorAbono.toFixed(2)}</p>` : ``}
        <p><strong>Total a receber (bruto): R$ ${total.toFixed(2)}</strong></p>
        <p class="hint">*C√°lculo simplificado, sem descontos (INSS/IR) e sem m√©dias de adicionais.</p>
      `;
      out.style.display = "block";
      out.classList.remove("fade");
      void out.offsetWidth; // reflow
      out.classList.add("fade");

      localStorage.setItem("dadosFerias", JSON.stringify({ salario, dias, diasAbono: abonoAjustado }));
    }

    function exemploFerias() {
      document.getElementById('salarioFerias').value = 3000;
      document.getElementById('diasFerias').value = 30;
      atualizarLimiteAbono();
      document.getElementById('diasAbono').value = 10; // 1/3 de 30
      calcularFerias();
    }

    // ---------- Carregar estado salvo ----------
    window.onload = function () {
      // Aba
      const aba = localStorage.getItem('aba');
      if (aba === 'ferias') mudarAba('ferias');

      // Hora extra
      const dh = JSON.parse(localStorage.getItem("dadosHora") || "null");
      if (dh) {
        document.getElementById('salario').value = dh.salario;
        document.getElementById('horas').value = dh.horas;
        document.getElementById('percentual').value = dh.percentual;
        document.getElementById('carga').value = dh.carga;
      }

      // F√©rias
      const df = JSON.parse(localStorage.getItem("dadosFerias") || "null");
      if (df) {
        document.getElementById('salarioFerias').value = df.salario;
        document.getElementById('diasFerias').value = df.dias;
        atualizarLimiteAbono();
        document.getElementById('diasAbono').value = df.diasAbono ?? 0;
      } else {
        atualizarLimiteAbono();
      }
    };
  </script>
</body>
</html>
